/**
 * jquery.verySimpleImageViewer.js
 * Ver. : 1.0.2
 * last update: 05/08/2018
 * Author: meshesha , https://github.com/meshesha
 * LICENSE: MIT
 * url:https://meshesha.github.io/verySimpleImageViewer
 */
!function(I){function b(e,t){if("number"==typeof e)return e;var o=e.indexOf(t);return parseInt(e.substring(0,-1!=o?o:e.length))}function B(e){var t=0,o=0;return e||(e=window.event),e.pageX||e.pageY?(t=e.pageX,o=e.pageY):e.clientX||e.clientY?(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,o=e.clientY+document.body.scrollTop+document.documentElement.scrollTop):(e.touches[0].pageX||e.touches[0].pageY)&&(t=e.touches[0].pageX,o=e.touches[0].pageY),[t,o]}function k(){var o=function(e,t,o){};this.wheelHandler=function(e){var t=0;e||(e=window.event),e.wheelDelta?t=e.wheelDelta/120:e.detail&&(t=-e.detail/3),e.preventDefault&&e.preventDefault(),e.returnValue=!1,t&&o(e,this,t)},this.init=function(e,t){e.addEventListener&&e.addEventListener("DOMMouseScroll",this.wheelHandler,!1),e.onmousewheel=this.wheelHandler,o=t},this.setCallback=function(e){o=e}}I.fn.verySimpleImageViewer=function(e){var t=I.extend({imageSource:"",frame:["720px","480px",!0],maxZoom:"300%",zoomFactor:"10%",saveZoomPos:!0,setZoomPos:[],mouse:!0,keyboard:!0,toolbar:!0,rotateToolbar:!1},e),o=t.imageSource,c=t.frame,n=t.maxZoom,l=t.zoomFactor,p=t.saveZoomPos,g=t.setZoomPos,f=t.mouse,A=t.keyboard,h=t.toolbar,m=t.rotateToolbar,v=this,i=I(this)[0],y=i.id,w=null,r=0;v.frameElement=null;var E,C,u=0,a=null,s=5;if(v.getFrameDimension=function(){return[v.frameElement.clientWidth,v.frameElement.clientHeight]},v.setDimension=function(e,t){w.width=Math.round(e),w.height=Math.round(t)},v.getDimension=function(){return[w.width,w.height]},v.setPosition=function(e,t){w.style.left=Math.round(e)+"px",w.style.top=Math.round(t)+"px"},v.getPosition=function(){return[b(w.style.left,"px"),b(w.style.top,"px")]},v.setMouseCursor=function(){var e=v.getDimension(),t=v.getFrameDimension(),o="crosshair";e[0]>t[0]&&e[1]>t[1]?o="move":e[0]>t[0]?o="e-resize":e[1]>t[1]&&(o="n-resize"),w.style.cursor=o},v.maxZoomCheck=function(e,t){if(void 0===e||void 0===t){var o=v.getDimension();e=o[0],t=o[1]}return"number"==typeof n?n<e/E||n<t/C:"object"==typeof n?e>n[0]||t>n[1]:void 0},v.fitToFrame=function(e,t){void 0!==e&&void 0!==t||(e=E,t=C);var o,n,i=v.getFrameDimension();return o=i[0],(n=Math.round(o*t/e))>i[1]&&(n=i[1],o=Math.round(n*e/t)),[o,n]},v.getZoomLevel=function(){return u},v.zoomTo=function(e,t,o){var n=v.getFrameDimension();if(e<0||t<0||o<0||t>=n[0]||o>=n[1])return!1;for(var i=v.fitToFrame(E,C),r=e;0<r;r--)i[0]*=l,i[1]*=l;var a=w.width,s=w.height,m=v.getPosition();return m[0]-=(t-m[0])*(i[0]/a-1),m[1]-=(o-m[1])*(i[1]/s-1),m=v.centerImage(i[0],i[1],m[0],m[1]),!v.maxZoomCheck(i[0],i[1])&&(v.setZoomPosition(e,i[0],i[1],m[0],m[1]),p&&"undefined"!=typeof Storage&&(localStorage.setItem(y+"_zoomlvl",u),localStorage.setItem(y+"_dimensionx",i[0]),localStorage.setItem(y+"_dimensiony",i[1]),localStorage.setItem(y+"_positionx",m[0]),localStorage.setItem(y+"_positiony",m[1])),!0)},v.setZoomPosition=function(e,t,o,n,i){u=parseInt(e),v.setDimension(t,o),v.setPosition(n,i),v.setMouseCursor()},v.getZoomInf=function(){var e=v.getDimension(),t=v.getPosition();console.log("[zoomLevel, dimensionX, dimensionY, positionX, positionY]="),console.log("[",u,",",e[0],",",e[1],",",t[0],",",t[1],"]")},v.centerImage=function(e,t,o,n){var i;void 0!==e&&void 0!==t||(e=(i=v.getDimension())[0],t=i[1]);void 0!==o&&void 0!==n||(o=(i=v.getPosition())[0],n=i[1]);var r=v.getFrameDimension();return e<=r[0]&&(o=Math.round((r[0]-e)/2)),t<=r[1]&&(n=Math.round((r[1]-t)/2)),e>r[0]&&(0<o?o=0:o+e<r[0]&&(o=r[0]-e)),t>r[1]&&(0<n?n=0:n+t<r[1]&&(n=r[1]-t)),[o,n]},v.rotate=function(e,t){"1"==e?r+=90:r-=90,t?I("."+v.frameElement.className+" .jqvsiv_main_image_content").css("transform","rotate(0deg)"):I("."+v.frameElement.className+" .jqvsiv_main_image_content").css("transform","rotate("+r+"deg)")},v.reset=function(){var e=v.fitToFrame(E,C),t=v.centerImage(e[0],e[1],0,0);v.setDimension(e[0],e[1]),v.setPosition(t[0],t[1]),u=0,v.rotate("1",!0)},v.onmousewheel=function(e,t,o){if(v.frameElement.focus(),e?e.preventDefault&&e.preventDefault():(e=window.event).returnValue=!1,0<=u+o){var n=B(e),i=function(e){var t,o;if((objectCopy=e).offsetParent)for(t=o=0;t+=e.offsetLeft,""!=e.style.borderLeftWidth?t+=parseInt(e.style.borderLeftWidth):e.style.borderLeftWidth="0px",o+=e.offsetTop,""!=e.style.borderTopWidth?o+=parseInt(e.style.borderTopWidth):e.style.borderTopWidth="0px",e=e.offsetParent;);return[t-parseInt(objectCopy.style.borderLeftWidth),o-parseInt(objectCopy.style.borderLeftWidth)]}(v.frameElement);v.zoomTo(u+o,n[0]-i[0],n[1]-i[1])}},v.onmousemove=function(e){e?e.preventDefault&&e.preventDefault():(e=window.event).returnValue=!1;var t=B(e),o=v.getPosition();o[0]+=t[0]-a[0],o[1]+=t[1]-a[1],a=t,o=v.centerImage(w.width,w.height,o[0],o[1]),v.setPosition(o[0],o[1]),p&&"undefined"!=typeof Storage&&(localStorage.setItem(y+"_positionx",o[0]),localStorage.setItem(y+"_positiony",o[1]))},v.onmouseup_or_out=function(e){e?e.preventDefault&&e.preventDefault():(e=window.event).returnValue=!1,w.onmousemove=w.onmouseup=w.onmouseout=null,w.onmousedown=v.onmousedown,w.ontouchmove=w.ontouchend=w.ontouchcancel=null,w.ontouchstart=v.onmousedown},v.onmousedown=function(e){v.frameElement.focus(),e?e.preventDefault&&e.preventDefault():(e=window.event).returnValue=!1,a=B(e),w.onmousemove=v.onmousemove,w.onmouseup=w.onmouseout=v.onmouseup_or_out,w.ontouchmove=v.onmousemove,w.ontouchend=w.ontouchcancel=v.onmouseup_or_out},v.onkeypress=function(e){var t;window.event?(t=(e=window.event).keyCode,e.returnValue=!1):e.which&&(t=e.which,e.preventDefault()),t=String.fromCharCode(t);var o=v.getPosition();"a"==t?o[0]+=s:"w"==t?o[1]+=s:"d"==t?o[0]-=s:"s"==t?o[1]-=s:"c"==t||"C"==t?v.reset():"="==t||"+"==t||"x"==t||"X"==t?v.zoomTo(u+1,v.frameElement.clientWidth/2,v.frameElement.clientHeight/2):("-"==t||"z"==t||"Z"==t)&&0<u?v.zoomTo(u-1,v.frameElement.clientWidth/2,v.frameElement.clientHeight/2):"i"!=t&&"I"!=t||v.getZoomInf(),"a"!=t&&"w"!=t&&"d"!=t&&"s"!=t||(o=v.centerImage(w.width,w.height,o[0],o[1]),v.setPosition(o[0],o[1]),s+=2,p&&"undefined"!=typeof Storage&&(localStorage.setItem(y+"_positionx",o[0]),localStorage.setItem(y+"_positiony",o[1])))},v.onkeyup=function(e){s=5},v.setZoomProp=function(e,t){null==e&&(l=10),l=1+b(e,"%")/100,"string"==typeof t?n=b(t,"%")/100:"object"==typeof t&&null!=t?(n[0]=b(t[0],"px"),n[1]=b(t[1],"px")):n="300%"},v.initImage=function(){E=w.width,C=w.height;var e=v.fitToFrame(E,C);v.setDimension(e[0],e[1]),1==c[2]&&(v.frameElement.style.width=Math.round(e[0])+"px"),1==c[3]&&(v.frameElement.style.height=Math.round(e[1])+"px");var t=v.centerImage(e[0],e[1],0,0);if(v.setPosition(t[0],t[1]),v.setMouseCursor(),f&&((new k).init(w,v.onmousewheel),w.onmousedown=v.onmousedown,w.ontouchstart=v.onmousedown),A&&(v.frameElement.onkeypress=v.onkeypress,v.frameElement.onkeyup=v.onkeyup),h&&v.loadToolbar(v),p&&"undefined"!=typeof Storage){var o=localStorage.getItem(y+"_zoomlvl"),n=localStorage.getItem(y+"_dimensionx"),i=localStorage.getItem(y+"_dimensiony"),r=localStorage.getItem(y+"_positionx"),a=localStorage.getItem(y+"_positiony");null!==o&&v.setZoomPosition(o,n,i,r,a)}if(5==g.length){var s=g[0],m=g[1],l=g[2],u=g[3],d=g[4];v.setZoomPosition(s,m,l,u,d)}else 0<g.length&&g.length<5&&console.log("Error: 'setZoomPos' setting array must contain 5 numbers: [zoomLevel, dimensionX, dimensionY, positionX, positionY].'\nclick 'i' key after zooming the image to see this information in the console.")},v.frameElement=document.createElement("div"),v.frameElement.className="image_viewer_inner_container",v.frameElement.style.width=c[0],v.frameElement.style.height=c[1],v.frameElement.style.border="0px solid #000",v.frameElement.style.margin="0px",v.frameElement.style.padding="0px",v.frameElement.style.overflow="hidden",v.frameElement.style.position="relative",v.frameElement.style.zIndex=2,v.frameElement.tabIndex=1,v.setZoomProp(l,n),null!=w)null!=i?(w.parentNode.removeChild(w),i.appendChild(v.frameElement)):w.parentNode.replaceChild(v.frameElement,w),w.style.margin=w.style.padding="0",w.style.borderWidth="0px",w.style.position="absolute",w.style.zIndex=3,v.frameElement.appendChild(w);else{null!=i&&i.appendChild(v.frameElement);var d=document.createElement("div");d.className="jqvsiv_main_image_content",(w=document.createElement("img")).style.position="absolute",w.style.zIndex=3,d.appendChild(w),v.frameElement.appendChild(d),w.onload=v.initImage,w.src=o}v.loadToolbar=function(o){var e=document.createElement("div");e.className="jqvsiv_toolbar";var n=function(e){var t;return e.keyCode?(t=e.keyCode,e.returnValue=!1):e.which&&(t=e.which,e.preventDefault()),13==t},t=document.createElement("img");t.className="jqvsiv_toolbarButton",t.title="Zoom in",t.tabIndex="1",t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAABN0lEQVRIic3WMW6DMBQGYN+EqhGJJYZMvUMHpByAKceIKpYuGUqmLjFESIm6pQORgpSJwNYoYsiQsSfB9utSUBKZYgcs1dI/4s+8Z2NQf54MMUnzAUk5Jil0kd+58v48GSJM0ryriQXJUZcrF70J0rh6wCSF/wVYfgaWn+kBRusjUMaBMg72at89MN6eoBxOGIPpRXqBhxdfCmkFyCC1wGh9hPH2VOXt67sCprsDOGFcxV4maoDlZ0AZB9lRUAZ4ttEL9NxAWK7aEtmr/VUZprtDbYme3z9re/Jnk00vqh50wljYZFEukcZdVCIqwCUitU1NL1IGSkT6HNjLBArKoKDsquZNUfuazjbQcwPpydWBm8ZrAVSRu69MGcSYBLzVpd+EGO7ijNr+togQYxJww12cH18/nn4Aw1rF5Pti/U4AAAAASUVORK5CYII=",t.onclick=t.onkeypress=function(e){if("keypress"!=(e=e||window.event).type||n(e)){var t=o.getFrameDimension();o.zoomTo(o.getZoomLevel()+1,t[0]/2,t[1]/2)}};var i=document.createElement("img");i.className="jqvsiv_toolbarButton",i.title="Zoom out",i.tabIndex="1",i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAA3klEQVRIiWNQm7FPX2PmgbPqMw/805h54D81MNSss2oz9ukzaMw8cJZaBmPBZxmo6XJsPmGgoev/a8w88H/UglELaGiB/+rT/xO3XCQK+68+TZoF2rMO/v/z999/YsHvP3//a/Rtoq0FyrWz/6v2biQ+iHwWHfgfPW8rUdhj8pr/CtWz/itUz8KwBG8kq/ZsgGskBSNbQjAVUWoJUcmUEkuIzgfkWkJSRiPHEpJzMqmWkFVUkGIJ2VUmMZbIV87+R1GlT8gS+do5VxkobbZgs0S+cvY/+do5V5WalpgCAJUZolx/yaTFAAAAAElFTkSuQmCC",i.onclick=i.onkeypress=function(e){if("keypress"!=(e=e||window.event).type||n(e)){var t=o.getFrameDimension();o.zoomTo(o.getZoomLevel()-1,t[0]/2,t[1]/2)}};var r=document.createElement("img");if(r.className="jqvsiv_toolbarButton",r.title="Center image",r.tabIndex="1",r.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAABmklEQVRIic3WvWrCUBQH8LyJomiCQwO+Q7u0bl0FX0MsqCA6CEIXa+LXJqhQQUEc2pBqEWkJlXQrzSA6VKEfLkUo5t+hNURNNNEUeuGMOb+bc8/hXsKd4WiK4QWS4WWK4WFF/OYS3BmOJiiGF6xKrBECYeXOtf6E+MPdg2J4/H+AzrURaPStBU4q9/AWOqBzbXSGr5jLMvzVrnVAU5rg4eUD3dEbAODmaQgynIcrVd8f8LA8prMvLNbt8whkOA97iIU9xK4hpoHTSwHqJQzG8ESLCrCKmAaSPUlJ/v45Q0OUcHheXQLUiGkgci0i3urBl67BcZZdS7yKbAU87E9Zkj0JEe4R1AUHZ6y0MbE6dIHjyh2a0mTpQOOtHpyxkilEF/AWOuiPp0sH6kvXYA+xphBdgM61lT5fHKi65kYRTWAxoYs+FwZjNERp7WMjiCYQaPQxl2VlQj3RIo40WtEIolsif7W7NKGbYhOysU1dqbrhdtRDts7BvoihK3NXxBbMyoYv/V0QR6IsEmaeLUYRWzArOxJlkUxfHXwDNFegvBR/iaAAAAAASUVORK5CYII=",r.onclick=r.onkeypress=function(e){("keypress"!=(e=e||window.event).type||n(e))&&o.reset()},m){var a=document.createElement("img");a.className="jqvsiv_toolbarButton",a.title="Center image",a.tabIndex="1",a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAB1ElEQVRIieXWwUvbYBjH8fwndRW7CoID3Wn3nYSdxIviQQa7bHdp62GIXvTiEBpTqUyZssKglk4UtJlawUmKshUtgtV6kMEs2m2lmpjvLrbM2TdrY3Yy8FwS+H3e503e943kCa60emVVeyirpldWcaKuszRPcKVV8sqq5lRwldIkJ0derRPpP44er6xyj4BXS2mKuoGcOuLR5KqzwJO3G6znTjEB48rk16XOSDLjDPBi4Quiq2k0ejegL75TCTvOFzCBC8Pg8PScrlCM2a1deiMb9oGD/E8A3iRSdIfjZL+f44+u4fYr9E4tVHCPRSdC4FlkC4CzYonGgEKDb+JGuf0KZ8USAB3jH4TTJQReLn0FYDN7ciu8XJvZEwCezyzS4JuoigiBnvltAHL5ghDI5QsAPB2LVO79jQiBFuUTPy50ALrD8VvhPeGPAJR0gwf+m8/+RCxf8nByH66//YFYkvbhadqGphmIJbkyTQB80bWq3ZURS6BZVpn6nBGug/daRjh9ZeTfKzmYoG9OZXnviOKlTkk3SOW+0anMW4aXq7a9KJigcfBdTYH2gDsg9W3XNpD6j8w6EFe/Yto79GtEXIFQWrL922KBuPoV0xUIpd2vZx7/Bh7Ty4bjzETnAAAAAElFTkSuQmCC",a.onclick=a.onkeypress=function(e){("keypress"!=(e=e||window.event).type||n(e))&&o.rotate("1")};var s=document.createElement("img");s.className="jqvsiv_toolbarButton",s.title="Center image",s.tabIndex="1",s.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAACQklEQVRIie3W3U9SYRwH8POfcEDj0Mtcq7XVP9BVra2tyy5aba1/wQOI2dxq3rQSeQ4qIdiLthZtNcSXc0wj8zgQCSEqmHOYLwnMCBU559uFwxREXoK7nu13+/38nme/59lDMcaRJjXhvYxJkDREQC2KMQmSmvBexjjSRKkJ761VcH6pCe+latn5YTuh6hWeq/9AbYBbb+cwubi+ubG9s5PYykhDkVVcfzP7b8BxIuDSgAjiXQAABJZ+Sh3DIh7xHoRX4llJlmFyzy9UDVwZFAEAsY10+pkYRKO+G+fv9+NMex9UWjN63X7IMnB74H2gKuCO04/cevc5Aprl8NLzBR3DImiWg0prxtfVBJyBKBru2T9WDOgmwsup7Qx6Pvhx4UF/AUCzHCxuP+K/N0GzXFGkKHCKjKcbW3vDuTCa5fB0Oojp6A+cbbeBZjn0TQX2AJrl0NBmK0COnCLGOBpX6syLuYATrRY8nwnhKnFA3dKDWOIXnIEo9jeRj5QcU+axK3bTNpRSac17Icf03XgxE0JWknHx4eABYBf5e1wlgRuvxVhWkhBaXgc34YN1KoDIWhKZrAStY7IgPB8p66Jds7jmHL5v+L6WxFIyhaH5KC53vioavh8pC2CIICvb7J9KBR5WZb9FjGlcUhmsYt2AXWQsSxusnroBGiJAY+IzSoN1tmyAIYJcKcJ0jW0pW574S4UrWCJRDBF8Fe+CCGC6+LRCbwkeCTRzQepkp+t01d8W02hKqTv4nOQ6VzRzQdVd+7k/U9So5+j1RlYAAAAASUVORK5CYII=",s.onclick=s.onkeypress=function(e){("keypress"!=(e=e||window.event).type||n(e))&&o.rotate("-1")}}e.appendChild(t),e.appendChild(i),m&&(e.appendChild(a),e.appendChild(s)),e.appendChild(r),o.frameElement.appendChild(e)}}}(jQuery);